---
title: 'Checking for the overlap of two ellipsoids with `pw85`'
tags:
  - C
  - Python
authors:
  - name: Sébastien Brisard
    orcid: 0000-0002-1976-6263
	affiliation: 1
affiliations:
  - name: Université Paris-Est, Laboratoire Navier, UMR 8205, CNRS, ENPC, IFSTTAR, F-77455 Marne-la-Vallée, France
    index: 1
date: 22 September 2019
bibliography: pw85.bib
---

# Introduction

It is quite common in materials science to reason on assemblies of ellipsoids as
model materials. Although simplified upscaling mean-field/effective-field
theories exist for such microstructures, they often fail to capture the finest
details of the microstructure, such as orientation correlations between
anisotropic inclusions, or particle-size distributions. In order to account for
such microstructural details, one must resort to so-called *full-field*
numerical simulations (using dedicated tools such as [Damask][damask] or
[Janus][janus], for example).

Full-field simulations require *realizations* of the microstructure. For
composites made of ellipsoidal inclusions embedded in a (homogeneous) matrix,
this requires to be able to generate assemblies of (non-overlapping)
ellipsoids. The basic ingredient of such microstructure simulations is of course
the overlap test of two inclusions.

Checking for the overlap (or the absence of it) of two ellipsoids is not as
trivial as checking for the overlap of two spheres. Several criteria can be
found in the literature [@viei1972; @perr1985; @wang2001; @chen2007;
@anou2018]. We require the overlap criterion to be implemented to be *robust*
and to somehow *quantify the “closeness”* of the two ellipsoids under
consideration. These two requirements are discussed below.

# Requirements for a reliable overlap criterion

## Robustness with respect to floating-point errors

All overlap checks amount to checking for the sign of a real quantity
$\Phi(\mathcal E_1, \mathcal E_2)$ that depends on the two ellipsoids $\mathcal
E_1$ and $\mathcal E_2$. The ellipsoids do not overlap when $\Phi(\mathcal E_1,
\mathcal E_2)<0$; they do overlap when $\Phi(\mathcal E_1, \mathcal
E_2)>0$. Finally, we usually have $\Phi(\mathcal E_1, \mathcal E_2)=0$ when
$\mathcal E_1$ and $\mathcal E_2$ are in tangent contact (but it is important to
note that, depending on the overlap crtiterion, the converse is not necessarily
true).

In a finite precision setting, we are bound to make wrong decisions about pairs
of ellipsoids that are such that $\Phi$ is small. Indeed, let us consider a pair
of ellipsoids $(\mathcal E_1, \mathcal E_2)$ for which the true value of $\Phi$,
$\Phi_\text{exact}(\mathcal E_1, \mathcal E_2)$, is close to the machine
epsilon. Then, the numerical estimate of $\Phi$, $\Phi_\text{approx}(\mathcal
E_1, \mathcal E_2)$, is also (hopefully) a very small value. However, whether
$\Phi_\text{approx}(\mathcal E_1, \mathcal E_2)$ is the same sign as
$\Phi_\text{exact}(\mathcal E_1, \mathcal E_2)$ (and therefore delivers the
correct answer regarding overlap) is uncertain, owing to accumulation of
round-off errors. Such misclassifications are acceptable provided that they
occur for ellipsoids that are close (nearly in tangent contact). The overlap
criterion will be deemed robust if it is such that $\Phi(\mathcal E_1, \mathcal
E_2)$ is small for nearly tangent ellipsoids only.

## Application to Monte-Carlo simulations

More generally, we require the criterion to deliver a “measure of closeness”:
$\Phi(\mathcal E_1, \mathcal E_2)$ should increase with the center-to-center
distance between the ellipsoids $\mathcal E_1$ and $\mathcal E_2$. Indeed,
generating compact assemblies of hard particles is notoriously
difficult. Event-driven simulations [@done2005; @done2005a] are often used, but
require a lot of book-keeping. A comparatively simpler approach [@bris2013] is
similar to atomistic simulations with a non-physical energy. More precisely,
starting from an initial configuration where the $N$ ellipsoids $\mathcal E_1,
\ldots, \mathcal E_N$ do overlap, a simulated annealing strategy is adopted to
minimize the quantity $J(\mathcal E_1,\ldots,\mathcal E_N)$ defined as follows

$$J(\mathcal E_1,\ldots,\mathcal E_N)=-\sum_{1\leq i<j\leq N}\Phi^-(\mathcal
E_1, \mathcal E_j),$$

where $\Phi^-(\mathcal E_1, \mathcal E_2)$ denotes the infimum of $\Phi(\mathcal
E_1, \mathcal E_2)$ and $0$. Note that the above defined energy $J$ indeed has a
minimum ($J=0$) for an assembly of non-overlapping ellipsoids. Note also that an
overlap-free configuration might not be reached through this procedure (the
assembly of ellipsoids might be trapped in a local minimum). Regardless of these
restrictions, the above procedure makes sense only if $-\Phi(\mathcal E_1,
\mathcal E_2)$ decreases when the overlap between $\mathcal E_1$ and $\mathcal
E_2$ is reduced (in a sense that is deliberately kept vague).

# The criterion of [@perr1985]

# Implementation

# References


[damask]: https://damask.mpie.de/ "DAMASK — the Düsseldorf Advanced Material Simulation Kit"
[janus]: https://github.com/sbrisard/janus "Janus"

<!-- Local Variables: -->
<!-- compile-command: "pandoc -s --filter pandoc-citeproc --mathjax -o pw85.html pw85.md" -->
<!-- fill-column: 80 -->
<!-- End: -->
