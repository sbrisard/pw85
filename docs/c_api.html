
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>The C API &#8212; PW85 1.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The python API" href="py_api.html" />
    <link rel="prev" title="Testing the implementation of the contact function" href="testing.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="the-c-api">
<h1>The C API<a class="headerlink" href="#the-c-api" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#representation-of-vectors-and-matrices" id="id5">Representation of vectors and matrices</a></p></li>
<li><p><a class="reference internal" href="#on-public-and-private-functions" id="id6">On “public” and “private” functions</a></p></li>
<li><p><a class="reference internal" href="#the-new-api" id="id7">The new API</a></p></li>
<li><p><a class="reference internal" href="#the-legacy-api" id="id8">The “legacy” API</a></p></li>
</ul>
</div>
<div class="section" id="representation-of-vectors-and-matrices">
<h2><a class="toc-backref" href="#id5">Representation of vectors and matrices</a><a class="headerlink" href="#representation-of-vectors-and-matrices" title="Permalink to this headline">¶</a></h2>
<p>An ellipsoid is defined from its center <code class="docutils literal notranslate"><span class="pre">c</span></code> (a 3×1, column-vector) and
quadratic form <code class="docutils literal notranslate"><span class="pre">Q</span></code> (a 3×3, symmetric, positive definite matrix) as the set of
points <code class="docutils literal notranslate"><span class="pre">m</span></code> such that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(m-c)ᵀ⋅Q⁻¹⋅(m-c) ≤ 1.
</pre></div>
</div>
<p>In this module, objects referred to as “vectors” are <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> arrays of
coordinates. In other words, the representation of the vector <code class="docutils literal notranslate"><span class="pre">x</span></code> is the
<code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array <code class="docutils literal notranslate"><span class="pre">x</span></code> such that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    ⎡ x[0] ⎤
x = ⎢ x[1] ⎥.
    ⎣ x[2] ⎦
</pre></div>
</div>
<p>Objects referred to as “symmetric matrices” (or “quadratic forms”) are of type
<code class="docutils literal notranslate"><span class="pre">double[6]</span></code>. Such arrays list in row-major order the coefficients of the
triangular upper part. In other words, the representation of a the symmetric
matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array <code class="docutils literal notranslate"><span class="pre">a</span></code> such that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    ⎡ a[0] a[1] a[2] ⎤
A = ⎢      a[3] a[4] ⎥.
    ⎣ sym.      a[5] ⎦
</pre></div>
</div>
</div>
<div class="section" id="on-public-and-private-functions">
<h2><a class="toc-backref" href="#id6">On “public” and “private” functions</a><a class="headerlink" href="#on-public-and-private-functions" title="Permalink to this headline">¶</a></h2>
<p>For testing purposes, all functions are exposed in this library. However,
functions prefixed with two underscores (<code class="docutils literal notranslate"><span class="pre">pw85__function_name</span></code> or
<code class="docutils literal notranslate"><span class="pre">pw85_legacy__function_name</span></code>) should be considered as private. Allthough they
are exposed and documented, their use is discouraged.</p>
</div>
<div class="section" id="the-new-api">
<h2><a class="toc-backref" href="#id7">The new API</a><a class="headerlink" href="#the-new-api" title="Permalink to this headline">¶</a></h2>
<p>The functions and macros gathered below form the new API that should be invoked
by most users. To use these functions and macros in your code, you must include
the following header:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;pw85.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>and use the following link directive:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-lpw85
</pre></div>
</div>
<dl class="macro">
<dt id="c.PW85_VERSION">
<code class="sig-name descname">PW85_VERSION</code><a class="headerlink" href="#c.PW85_VERSION" title="Permalink to this definition">¶</a></dt>
<dd><p>The current version of the library.</p>
</dd></dl>

<dl class="macro">
<dt id="c.PW85_DIM">
<code class="sig-name descname">PW85_DIM</code><a class="headerlink" href="#c.PW85_DIM" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimension of the physical space (3).</p>
</dd></dl>

<dl class="macro">
<dt id="c.PW85_SYM">
<code class="sig-name descname">PW85_SYM</code><a class="headerlink" href="#c.PW85_SYM" title="Permalink to this definition">¶</a></dt>
<dd><p>The dimension of the space of symmetric matrices (6).</p>
</dd></dl>

<dl class="macro">
<dt id="c.PW85_LAMBDA_ATOL">
<code class="sig-name descname">PW85_LAMBDA_ATOL</code><a class="headerlink" href="#c.PW85_LAMBDA_ATOL" title="Permalink to this definition">¶</a></dt>
<dd><p>The absolute tolerance for the stopping criterion of Brent’s method (in
function <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a>).</p>
</dd></dl>

<dl class="macro">
<dt id="c.PW85_MAX_ITER">
<code class="sig-name descname">PW85_MAX_ITER</code><a class="headerlink" href="#c.PW85_MAX_ITER" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum number of iterations of Brent’s method (in function
<a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a>).</p>
</dd></dl>

<dl class="macro">
<dt id="c.PW85_NR_ITER">
<code class="sig-name descname">PW85_NR_ITER</code><a class="headerlink" href="#c.PW85_NR_ITER" title="Permalink to this definition">¶</a></dt>
<dd><p>The total number of iterations of the Newton–Raphson refinement phase (in
function <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a>).</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85__cholesky_decomp">
void <code class="sig-name descname">pw85__cholesky_decomp</code><span class="sig-paren">(</span>double const<em> a[PW85_SYM]</em>, double<em> l[PW85_SYM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85__cholesky_decomp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Cholesky decomposition of a symmetric, positive matrix.</p>
<p>Let <code class="docutils literal notranslate"><span class="pre">A</span></code> be a symmetric, positive matrix, defined by the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array
<code class="docutils literal notranslate"><span class="pre">a</span></code>. This function computes the lower-triangular matrix <code class="docutils literal notranslate"><span class="pre">L</span></code>, defined by
the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array <code class="docutils literal notranslate"><span class="pre">l</span></code>, such that <code class="docutils literal notranslate"><span class="pre">Lᵀ⋅L</span> <span class="pre">=</span> <span class="pre">A</span></code>.</p>
<p>The array <code class="docutils literal notranslate"><span class="pre">l</span></code> must be pre-allocated; it is modified by this function. Note
that storage of the coefficients of <code class="docutils literal notranslate"><span class="pre">L</span></code> is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>    ⎡ l[0]    0    0 ⎤
L = ⎢ l[1] l[3]    0 ⎥.
    ⎣ l[2] l[4] l[5] ⎦
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="c.pw85__cholesky_solve">
void <code class="sig-name descname">pw85__cholesky_solve</code><span class="sig-paren">(</span>double const<em> l[PW85_SYM]</em>, double const<em> b[PW85_DIM]</em>, double<em> x[PW85_DIM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85__cholesky_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the solution to a previously Cholesky decoposed linear system.</p>
<p>Let <code class="docutils literal notranslate"><span class="pre">L</span></code> be a lower-triangular matrix, defined by the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array
<code class="docutils literal notranslate"><span class="pre">l</span></code> (see <a class="reference internal" href="#c.pw85__cholesky_decomp" title="pw85__cholesky_decomp"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85__cholesky_decomp()</span></code></a> for ordering of the
coefficients). This function solves (by substitution) the linear system
<code class="docutils literal notranslate"><span class="pre">Lᵀ⋅L⋅x</span> <span class="pre">=</span> <span class="pre">b</span></code>, where the vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are specfied through their
<code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array of coordinates; <code class="docutils literal notranslate"><span class="pre">x</span></code> is modified by this function.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85__residual">
void <code class="sig-name descname">pw85__residual</code><span class="sig-paren">(</span>double<em> lambda</em>, double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double<em> out[3]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85__residual" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the residual <code class="docutils literal notranslate"><span class="pre">g(λ)</span> <span class="pre">=</span> <span class="pre">μ₂²</span> <span class="pre">-</span> <span class="pre">μ₁²</span></code>.</p>
<p>See <a class="reference internal" href="optimization.html#optimization"><span class="std std-ref">Optimization of the function f</span></a> for the definition of <code class="docutils literal notranslate"><span class="pre">g</span></code>. The value of <code class="docutils literal notranslate"><span class="pre">λ</span></code> is
specified through the parameter
<code class="docutils literal notranslate"><span class="pre">lambda</span></code>. See <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a> for the definition of the
parameters <code class="docutils literal notranslate"><span class="pre">r12</span></code>, <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>.</p>
<p>The preallocated <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array <code class="docutils literal notranslate"><span class="pre">out</span></code> is updated with the values of
<code class="docutils literal notranslate"><span class="pre">f(λ)</span></code>, <code class="docutils literal notranslate"><span class="pre">g(λ)</span></code> and <code class="docutils literal notranslate"><span class="pre">g’(λ)</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>out[0] = f(λ),    out[1] = g(λ)    and    out[2] = g’(λ).
</pre></div>
</div>
<p>This function is used in function <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a> for the
final Newton–Raphson refinement step.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_spheroid">
void <code class="sig-name descname">pw85_spheroid</code><span class="sig-paren">(</span>double<em> a</em>, double<em> c</em>, double<em> n[PW85_DIM]</em>, double<em> q[PW85_SYM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_spheroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the quadratic form associated to a spheroid.</p>
<p>The spheroid is defined by its equatorial radius <code class="docutils literal notranslate"><span class="pre">a</span></code>, its polar radius
<code class="docutils literal notranslate"><span class="pre">c</span></code> and the direction of its axis of revolution, <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">q</span></code> is the representation of a symmetric matrix as a <code class="docutils literal notranslate"><span class="pre">double[6]</span></code>
array. It is modified in-place.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_f_neg">
double <code class="sig-name descname">pw85_f_neg</code><span class="sig-paren">(</span>double<em> lambda</em>, double cons*<em> params</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_f_neg" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the opposite of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> defined as (see
<a class="reference internal" href="theory.html#theory"><span class="std std-ref">Theory</span></a>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>f(λ) = λ(1-λ)r₁₂ᵀ⋅Q⁻¹⋅r₁₂,
</pre></div>
</div>
<p>with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Q = (1-λ)Q₁ + λQ₂,
</pre></div>
</div>
<p>where ellipsoids 1 and 2 are defined as the sets of points <code class="docutils literal notranslate"><span class="pre">m</span></code>
(column-vector) such that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(m-cᵢ)⋅Qᵢ⁻¹⋅(m-cᵢ) ≤ 1
</pre></div>
</div>
<p>In the above inequality, <code class="docutils literal notranslate"><span class="pre">cᵢ</span></code> is the center; <code class="docutils literal notranslate"><span class="pre">r₁₂</span> <span class="pre">=</span> <span class="pre">c₂-c₁</span></code> is the
center-to-center radius-vector, represented by the first 3 coefficients of
the array <code class="docutils literal notranslate"><span class="pre">params</span></code>. The symmetric, positive-definite matrices <code class="docutils literal notranslate"><span class="pre">Q₁</span></code> and
<code class="docutils literal notranslate"><span class="pre">Q₂</span></code> are specified through the next 12 coefficients. In other words, if
<code class="docutils literal notranslate"><span class="pre">r12</span></code>, <code class="docutils literal notranslate"><span class="pre">Q1</span></code> and <code class="docutils literal notranslate"><span class="pre">Q2</span></code> were defined as usual by their <code class="docutils literal notranslate"><span class="pre">double[3]</span></code>,
<code class="docutils literal notranslate"><span class="pre">double[6]</span></code> and <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> arrays <code class="docutils literal notranslate"><span class="pre">r12</span></code>, <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>, then
<code class="docutils literal notranslate"><span class="pre">params</span></code> would be formed as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>double params[] = {r12[0], r12[1], r12[2],
                   q1[0], q1[1], q1[2], q1[3], q1[4], q1[5],
                   q2[0], q2[1], q2[2], q2[3], q2[4], q2[5]};
</pre></div>
</div>
<p>The value of <code class="docutils literal notranslate"><span class="pre">λ</span></code> is specified through the parameter <code class="docutils literal notranslate"><span class="pre">lambda</span></code>.</p>
<p>This function returns the value of <code class="docutils literal notranslate"><span class="pre">−f(λ)</span></code> (the “minus” sign comes from the
fact that we seek the maximum of <code class="docutils literal notranslate"><span class="pre">f</span></code>, or the minimum of <code class="docutils literal notranslate"><span class="pre">−f</span></code>).</p>
<p>This implementation uses <a class="reference internal" href="implementation.html#implementation-cholesky"><span class="std std-ref">Cholesky decompositions</span></a>. Its somewhat awkward signature is defined in
accordance with <code class="docutils literal notranslate"><span class="pre">gsl_min.h</span></code> from the GNU Scientific Library.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_contact_function">
int <code class="sig-name descname">pw85_contact_function</code><span class="sig-paren">(</span>double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double<em> out[2]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_contact_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the contact function of two ellipsoids.</p>
<p>The center-to-center radius-vector is specified by the <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array
<code class="docutils literal notranslate"><span class="pre">r12</span></code>. The symmetric, positive-definite matrices <code class="docutils literal notranslate"><span class="pre">Q₁</span></code> and <code class="docutils literal notranslate"><span class="pre">Q₂</span></code> that
define the two ellipsoides are specified through the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> arrays
<code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>.</p>
<p>This function returns the value of <code class="docutils literal notranslate"><span class="pre">μ²</span></code>, defined as (see <a class="reference internal" href="theory.html#theory"><span class="std std-ref">Theory</span></a>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>μ² = max{ λ(1-λ)r₁₂ᵀ⋅[(1-λ)Q₁ + λQ₂]⁻¹⋅r₁₂, 0 ≤ λ ≤ 1 },
</pre></div>
</div>
<p>and the maximizer <code class="docutils literal notranslate"><span class="pre">λ</span></code>. Both values are stored in the preallocated
<code class="docutils literal notranslate"><span class="pre">double[2]</span></code> array <code class="docutils literal notranslate"><span class="pre">out</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>out[0] = μ²    and    out[1] = λ.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">μ</span></code> is the common factor by which the two ellipsoids must be scaled (their
centers being fixed) in order to be tangentially in contact.</p>
<p>This function returns <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd></dl>

<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>This function should return an error code.</p>
</div>
</div>
<div class="section" id="the-legacy-api">
<h2><a class="toc-backref" href="#id8">The “legacy” API</a><a class="headerlink" href="#the-legacy-api" title="Permalink to this headline">¶</a></h2>
<p>The functions described below belong to the legacy API. These are functions
that have been superseded by equivalent (more accurate or more efficient)
implementations in the core library. To use these functions in your code, you
must include the following header:</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;pw85_legacy.h&gt;</span><span class="cp"></span>
</pre></div>
</div>
<p>and use the following link directive:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>-lpw85_legacy
</pre></div>
</div>
<dl class="function">
<dt id="c.pw85_legacy__det_sym">
double <code class="sig-name descname">pw85_legacy__det_sym</code><span class="sig-paren">(</span>double<em> a[PW85_SYM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy__det_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the determinant of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<p>The symmetric matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is specified through the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_legacy__xT_adjA_x">
double <code class="sig-name descname">pw85_legacy__xT_adjA_x</code><span class="sig-paren">(</span>double<em> x[PW85_DIM]</em>, double<em> a[PW85_SYM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy__xT_adjA_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product <code class="docutils literal notranslate"><span class="pre">xᵀ⋅adj(A)⋅x</span></code>.</p>
<p>The column vector <code class="docutils literal notranslate"><span class="pre">x</span></code> is specified as a <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array. The symmetric
matrix <code class="docutils literal notranslate"><span class="pre">A</span></code> is specified trough the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> array <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">adj(A)</span></code> denotes the adjugate matrix of <code class="docutils literal notranslate"><span class="pre">A</span></code> (transpose of its
cofactor matrix), see e.g <a class="reference external" href="https://en.wikipedia.org/wiki/Adjugate_matrix">Wikipedia</a>.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_legacy__detQ_as_poly">
void <code class="sig-name descname">pw85_legacy__detQ_as_poly</code><span class="sig-paren">(</span>double<em> q1[PW85_SYM]</em>, double<em> q2[PW85_SYM]</em>, double<em> q3[PW85_SYM]</em>, double<em> q4[PW85_SYM]</em>, double<em> b[PW85_DIM+1]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy__detQ_as_poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute the coefficients of the polynomial <code class="docutils literal notranslate"><span class="pre">λ</span> <span class="pre">↦</span> <span class="pre">det[(1-λ)Q₁+λQ₂]</span></code>.</p>
<p>The symmetric, positive definite, 3×3 matrices <code class="docutils literal notranslate"><span class="pre">Q₁</span></code> and <code class="docutils literal notranslate"><span class="pre">Q₂</span></code> are specified
as arrays <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>. The arrays <code class="docutils literal notranslate"><span class="pre">q3</span></code> and <code class="docutils literal notranslate"><span class="pre">q4</span></code> must hold the
difference <code class="docutils literal notranslate"><span class="pre">2Q₁-Q₂</span></code> and average <code class="docutils literal notranslate"><span class="pre">(Q₁+Q₂)/2</span></code>, respectively:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>q3[i] = 2*q1[i] - q2[i]  and  q4[i] = 0.5*(q1[i] + q2[i]),
</pre></div>
</div>
<p>for <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">…,</span> <span class="pre">PW85_SYM-1</span></code>. The returned polynomial has degree
<a class="reference internal" href="#c.PW85_DIM" title="PW85_DIM"><code class="xref c c-macro docutils literal notranslate"><span class="pre">PW85_DIM</span></code></a>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>det[(1-λ)Q₁+λQ₂] = b₀ + b₁λ + b₂λ² + b₃λ³.
</pre></div>
</div>
<p>The coefficients <code class="docutils literal notranslate"><span class="pre">bᵢ</span></code> are stored in <code class="docutils literal notranslate"><span class="pre">b</span></code> in <em>increasing</em> order: <code class="docutils literal notranslate"><span class="pre">b[i]</span> <span class="pre">=</span>
<span class="pre">bᵢ</span></code>.</p>
<dl class="function">
<dt id="c.pw85__rT_adjQ_r_as_poly">
double <code class="sig-name descname">pw85__rT_adjQ_r_as_poly</code><span class="sig-paren">(</span>double<em> r[PW85_DIM]</em>, double<em> q1[PW85_SYM]</em>, double<em> q2[PW85_SYM]</em>, double<em> q3[PW85_SYM]</em>, double<em> a[PW85_DIM]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85__rT_adjQ_r_as_poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Compute the coefficients of the polynomial <code class="docutils literal notranslate"><span class="pre">λ</span> <span class="pre">↦</span> <span class="pre">rᵀ⋅adj[(1-λ)Q₁+λQ₂]⋅r</span></code>.</p>
<p>The symmetric, positive definite, 3×3 matrices <code class="docutils literal notranslate"><span class="pre">Q₁</span></code> and <code class="docutils literal notranslate"><span class="pre">Q₂</span></code> are specified
as arrays <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>. The array <code class="docutils literal notranslate"><span class="pre">q3</span></code> must hold the difference
<code class="docutils literal notranslate"><span class="pre">2Q₁-Q₂</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>q3[i] = 2*q1[i] - q2[i],
</pre></div>
</div>
<p>for <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">…,</span> <span class="pre">PW85_SYM-1</span></code>. The returned polynomial has degree
<code class="docutils literal notranslate"><span class="pre">PW85_DIM</span> <span class="pre">-</span> <span class="pre">1</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>rᵀ⋅adj[(1-λ)Q₁+λQ₂]⋅r = a₀ + a₁λ + a₂λ².
</pre></div>
</div>
<p>The coefficients <code class="docutils literal notranslate"><span class="pre">aᵢ</span></code> are stored in <code class="docutils literal notranslate"><span class="pre">a</span></code> in <em>increasing</em> order: <code class="docutils literal notranslate"><span class="pre">a[i]</span> <span class="pre">=</span> <span class="pre">aᵢ</span></code>.</p>
<dl class="function">
<dt id="c.pw85_legacy_f1">
double <code class="sig-name descname">pw85_legacy_f1</code><span class="sig-paren">(</span>double<em> lambda</em>, double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double*<em> out</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy_f1" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> defined as (see <a class="reference internal" href="theory.html#theory"><span class="std std-ref">Theory</span></a>):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>f(λ) = λ(1-λ)r₁₂ᵀ⋅Q⁻¹⋅r₁₂,
</pre></div>
</div>
<p>with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Q = (1-λ)Q₁ + λQ₂,
</pre></div>
</div>
<p>where ellipsoids 1 and 2 are defined as the sets of points <code class="docutils literal notranslate"><span class="pre">m</span></code>
(column-vector) such that:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(m-cᵢ)⋅Qᵢ⁻¹⋅(m-cᵢ) ≤ 1
</pre></div>
</div>
<p>In the above inequality, <code class="docutils literal notranslate"><span class="pre">cᵢ</span></code> is the center; <code class="docutils literal notranslate"><span class="pre">r₁₂</span> <span class="pre">=</span> <span class="pre">c₂-c₁</span></code> is the
center-to-center radius-vector, represented by the <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array
<code class="docutils literal notranslate"><span class="pre">r12</span></code>. The symmetric, positive-definite matrices <code class="docutils literal notranslate"><span class="pre">Q₁</span></code> and <code class="docutils literal notranslate"><span class="pre">Q₂</span></code> are
specified through the <code class="docutils literal notranslate"><span class="pre">double[6]</span></code> arrays <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>.</p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">λ</span></code> is specified through the parameter <code class="docutils literal notranslate"><span class="pre">lambda</span></code>.</p>
<p>This function returns the value of <code class="docutils literal notranslate"><span class="pre">f(λ)</span></code>. If <code class="docutils literal notranslate"><span class="pre">out</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, then
it must be a pre-allocated <code class="docutils literal notranslate"><span class="pre">double[3]</span></code> array which is updated with the
values of the first and second derivatives:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>out[0] = f(λ),    out[1] = f&#39;(λ)    and    out[2] = f″(λ).
</pre></div>
</div>
<p>This implementation uses <a class="reference internal" href="implementation.html#implementation-cholesky"><span class="std std-ref">Cholesky decompositions</span></a>.</p>
</dd></dl>

<dl class="function">
<dt id="c.pw85_legacy_f2">
double <code class="sig-name descname">pw85_legacy_f2</code><span class="sig-paren">(</span>double<em> lambda</em>, double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double*<em> out</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy_f2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative implementation of <a class="reference internal" href="#c.pw85_legacy_f1" title="pw85_legacy_f1"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_legacy_f1()</span></code></a>.</p>
<p>See <a class="reference internal" href="#c.pw85_legacy_f1" title="pw85_legacy_f1"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_legacy_f1()</span></code></a> for the meaning of the parameters <code class="docutils literal notranslate"><span class="pre">lambda</span></code>,
<code class="docutils literal notranslate"><span class="pre">r12</span></code>, <code class="docutils literal notranslate"><span class="pre">q1</span></code> and <code class="docutils literal notranslate"><span class="pre">q2</span></code>.</p>
<p>This function returns the value of <code class="docutils literal notranslate"><span class="pre">f(λ)</span></code>. If <code class="docutils literal notranslate"><span class="pre">out</span></code> is not <code class="docutils literal notranslate"><span class="pre">NULL</span></code>, then
it must be a pre-allocated <code class="docutils literal notranslate"><span class="pre">double[1]</span></code> array which is updated with the
value of <code class="docutils literal notranslate"><span class="pre">f(λ)</span></code>.</p>
<p>This implementation uses <a class="reference internal" href="implementation.html#implementation-rational-functions"><span class="std std-ref">rational fractions</span></a>.</p>
</dd></dl>

<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>This function should also compute the first and second derivatives.</p>
</div>
<dl class="function">
<dt id="c.pw85_legacy_contact_function1">
int <code class="sig-name descname">pw85_legacy_contact_function1</code><span class="sig-paren">(</span>double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double<em> out[2]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy_contact_function1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the contact function of two ellipsoids.</p>
<p>See <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a> for the invocation of this function.</p>
<p>Implementation of this function relies on Newton–Raphson iterations on <code class="docutils literal notranslate"><span class="pre">f</span></code>;
it is not robust.</p>
<p>This function returns <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd></dl>

<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>This function should return an error code.</p>
</div>
<dl class="function">
<dt id="c.pw85_legacy_contact_function2">
int <code class="sig-name descname">pw85_legacy_contact_function2</code><span class="sig-paren">(</span>double const<em> r12[PW85_DIM]</em>, double const<em> q1[PW85_SYM]</em>, double const<em> q2[PW85_SYM]</em>, double<em> out[2]</em><span class="sig-paren">)</span><a class="headerlink" href="#c.pw85_legacy_contact_function2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the contact function of two ellipsoids.</p>
<p>See <a class="reference internal" href="#c.pw85_contact_function" title="pw85_contact_function"><code class="xref c c-func docutils literal notranslate"><span class="pre">pw85_contact_function()</span></code></a> for the invocation of this
function.</p>
<p>This implementation uses the representation of <code class="docutils literal notranslate"><span class="pre">f</span></code> as <a class="reference internal" href="implementation.html#implementation-rational-functions"><span class="std std-ref">rational
fractions</span></a>. Finding the maximum of <code class="docutils literal notranslate"><span class="pre">f</span></code>
is then equivalent to finding the root of the numerator of the rational
fraction of <code class="docutils literal notranslate"><span class="pre">f'</span></code>. For the sake of robustness, bisection is used to compute
this root.</p>
<p>This function returns <code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd></dl>

<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>This function should return an error code.</p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">PW85</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation.html">Implementation of the function <code class="docutils literal notranslate"><span class="pre">f</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization of the function <code class="docutils literal notranslate"><span class="pre">f</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing the implementation of the contact function</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The C API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#representation-of-vectors-and-matrices">Representation of vectors and matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#on-public-and-private-functions">On “public” and “private” functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-new-api">The new API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-legacy-api">The “legacy” API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="py_api.html">The python API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="testing.html" title="previous chapter">Testing the implementation of the contact function</a></li>
      <li>Next: <a href="py_api.html" title="next chapter">The python API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018–2019, Sébastien Brisard.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/c_api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>